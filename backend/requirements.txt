# ============================================================================
# BRAiN Backend - Fixed Requirements (Python Path Fix + Deps Resolved)
# ============================================================================
# Updated: 2026-01-03
# Fix: All dependency conflicts resolved (cognee, litellm compatible)
# ============================================================================

# --- Core FastAPI + Server ---
fastapi==0.116.2                # Updated for cognee compatibility
uvicorn[standard]==0.27.1
python-multipart>=0.0.20,<1.0.0 # ✅ Fixed: cognee needs >=0.0.20

# --- ASGI / Web Server ---
# starlette - removed, fastapi brings correct version automatically
websockets==12.0                # WebSocket support

# --- Database ---
sqlalchemy[asyncio]==2.0.27     # ORM with async support
asyncpg==0.29.0                 # Async PostgreSQL driver
alembic==1.13.3                 # Database migrations (required by cognee>=1.13.3)

# --- Redis ---
redis[hiredis]==5.0.1           # Redis client with hiredis for performance

# --- Pydantic (Data Validation) ---
pydantic>=2.10.5,<2.12.0        # ✅ Fixed: cognee compatible range
pydantic-settings>=2.2.1,<3     # ✅ Fixed: cognee compatible range

# --- HTTP Client ---
httpx>=0.24,<0.26               # Async HTTP client (for LLM API calls, compatible with supabase)

# --- Payment Processing ---
stripe==8.0.0                   # Stripe payment gateway SDK (PayCore module)

# --- Environment ---
python-dotenv==1.0.1

# --- Logging ---
loguru==0.7.2
python-json-logger==2.0.7

# --- Cryptography & Authentication ---
cryptography==42.0.2                # Ed25519 signatures for bundle signing (G1)
python-jose[cryptography]==3.3.0    # JWT token encoding/decoding
passlib[bcrypt]==1.7.4              # Password hashing (bcrypt)

# --- Background Jobs / Scheduling ---
APScheduler==3.10.4             # Background task scheduling

# --- CLI Tools ---
typer==0.9.0                    # CLI interface for brain_cli
rich==13.7.0                    # Beautiful terminal output

# --- Supabase Integration ---
supabase==2.3.4                 # Supabase client (for agent repository)

# --- Vector DB & Knowledge Graphs ---
qdrant-client==1.7.3            # Qdrant vector database client
cognee==0.5.1                   # Knowledge graph + vector memory platform

# --- LLM Providers ---
litellm>=1.76.0                 # Multi-LLM provider abstraction

# --- Development / Testing ---
pytest==8.0.1
pytest-asyncio==0.23.5
pytest-cov==4.1.0
pytest-httpx==0.30.0            # Mock HTTP requests in tests

# --- Code Quality (Development) ---
black==24.2.0                   # Code formatter
ruff==0.2.2                     # Fast Python linter
mypy==1.8.0                     # Static type checker

# --- Type Stubs ---
types-redis==4.6.0.20240218

# --- Monitoring ---
prometheus-client==0.20.0       # Metrics collection

# ============================================================================
# Key Fixes Applied:
# 1. python-multipart: 0.0.9 → >=0.0.20,<1.0.0 (cognee requirement)
# 2. pydantic: 2.6.1 → >=2.10.5,<2.12.0 (cognee requirement)
# 3. pydantic-settings: 2.1.0 → >=2.2.1,<3 (cognee requirement)
# 4. starlette: removed (fastapi manages it automatically)
# 5. litellm: added (user needs it)
# ============================================================================
