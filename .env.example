# ðŸ§  BRAIN Environment Configuration
# Copy to .env and fill in your values
#############################################
# B R A I N   â€“   GLOBAL CONFIG
#############################################

APP_ENV=development
APP_NAME=BRAIN-Core
APP_VERSION=0.3.0

# Options: development | staging | production
BRAiN_MODE=development

#############################################
# BACKEND / API
#############################################

# FastAPI host/port (Docker uses 0.0.0.0)
API_HOST=0.0.0.0
API_PORT=8000

# Enable/Disable Mission Worker loop
ENABLE_MISSION_WORKER=true

# Worker interval (seconds)
MISSION_WORKER_POLL_INTERVAL=2.0


#############################################
# POSTGRESQL
#############################################

POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=brain
POSTGRES_USER=brain
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# SQLAlchemy Database URL (async)
DATABASE_URL=postgresql+asyncpg://brain:CHANGE_ME_STRONG_PASSWORD@postgres:5432/brain


#############################################
# REDIS
#############################################

REDIS_URL=redis://redis:6379/0


#############################################
# QDRANT VECTOR DB
#############################################

QDRANT_HOST=qdrant
QDRANT_PORT=6333
QDRANT_API_KEY=
QDRANT_USE_HTTPS=false


#############################################
# LLM CLIENT (Ollama / OpenAI / LM Studio)
#############################################

# Default local LLM (Ollama)
LLM_PROVIDER=ollama

# Host inside Docker: http://host.docker.internal:11434
# Host local: http://localhost:11434
OLLAMA_HOST=http://host.docker.internal:11434
OLLAMA_MODEL=phi3

# Maximum tokens, temperature etc.
LLM_MAX_TOKENS=1024
LLM_TEMPERATURE=0.5


#############################################
# LLM ROUTER - Multi-Provider Access
#############################################

# === Router Settings ===
# Default provider: ollama | openrouter | openai | anthropic
LLM_DEFAULT_PROVIDER=ollama

# Enable automatic fallback to other providers
LLM_ENABLE_FALLBACK=true

# Response caching
LLM_CACHE_ENABLED=true
LLM_CACHE_TTL=3600  # seconds

# === Ollama (Local LLM) - For AXE Agent ===
# Use local Ollama for privacy, development, and AXE agent
OLLAMA_HOST=http://host.docker.internal:11434
OLLAMA_MODEL=llama3.2:latest

# === OpenRouter (Recommended for API access) ===
# Single API key for 100+ models (Claude, GPT-4, Gemini, Llama, etc.)
# Get your key from: https://openrouter.ai
OPENROUTER_API_KEY=sk-or-v1-your-key-here
OPENROUTER_MODEL=anthropic/claude-3.5-sonnet
OPENROUTER_SITE_URL=https://brain.falklabs.de
OPENROUTER_SITE_NAME=BRAiN

# Budget control (optional, in USD)
OPENROUTER_MAX_COST_PER_REQUEST=1.00

# === OpenAI (Direct) - Optional ===
# Use only if you need pure OpenAI models
OPENAI_API_KEY=sk-your-openai-key-here
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_ORGANIZATION=  # Optional organization ID

# === Anthropic (Direct) - Optional ===
# Use only if you need pure Anthropic/Claude models
ANTHROPIC_API_KEY=sk-ant-your-anthropic-key-here
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
ANTHROPIC_API_VERSION=2023-06-01


#############################################
# FRONTEND â€“ Control Deck
#############################################

NEXT_PUBLIC_API_BASE=http://localhost:8000


#############################################
# SUPERVISOR / HEALTH / AGENTS
#############################################

SUPERVISOR_ENABLE=true
AGENT_HEARTBEAT_INTERVAL=10
AGENT_TIMEOUT_SECONDS=60


#############################################
# DOCKER INTERNAL NETWORKING
#############################################

DOCKER_BRIDGE_NETWORK=brain_net


#############################################
# LOGGING
#############################################

LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE=logs/brain.log
LOG_FILE_MAX_BYTES=10485760
LOG_FILE_BACKUP_COUNT=5 # Number of backup log files to keep
LOG_ENABLE_CONSOLE=true

#############################################
# SECURITY
#############################################   
JWT_SECRET_KEY=CHANGE_ME_RANDOM_SECRET_KEY
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=300 # 5 hours
PASSWORD_SALT_ROUNDS=12 # bcrypt salt rounds
########################################################################################
# NOTE: Remember to change the default passwords and secret keys before deploying to production!
########################################################################################
#############################################
# EMAIL / SMTP SETTINGS
#############################################   
SMTP_HOST=smtp.example.com
SMTP_PORT=587   
SMTP_USER=your_smtp_user   
SMTP_PASSWORD=your_smtp_password    
SMTP_USE_TLS=true   

#############################################
# OTHER SETTINGS
#############################################
MAX_CONCURRENT_MISSIONS=5
MAX_MISSION_RETRIES=3
DEFAULT_TIMEZONE=UTC
ENABLE_API_CACHING=false
API_CACHE_TTL=300 # seconds
ENABLE_RATE_LIMITING=true
RATE_LIMIT_REQUESTS=100 # requests
RATE_LIMIT_TIME_WINDOW=60 # seconds

#############################################
# WEBGENESIS IR GOVERNANCE (Sprint 10)
#############################################

# IR enforcement mode: off | opt_in | required
# - off: IR disabled, legacy behavior (no governance)
# - opt_in: IR optional, accept both IR and legacy requests (DEFAULT)
# - required: IR mandatory, block legacy requests (fail-closed)
WEBGENESIS_IR_MODE=opt_in

# Minimum risk tier requiring approval (0-3)
# Tier 0: Safe, read-only (no approval)
# Tier 1: Low risk, dev/staging (no approval)
# Tier 2: Medium risk, requires approval (DEFAULT)
# Tier 3: High risk, critical operations (requires approval)
WEBGENESIS_REQUIRE_APPROVAL_TIER=2

# Maximum budget in cents (optional, leave empty for unlimited)
# Example: 500000 = $5000.00
WEBGENESIS_MAX_BUDGET=

# Default dry-run mode (true recommended for safety)
# true: Default to simulation, require explicit execute=true (DEFAULT)
# false: Default to live execution (NOT RECOMMENDED)
WEBGENESIS_DRY_RUN_DEFAULT=true

#############################################
# HITL APPROVAL SYSTEM (Sprint 11)
#############################################

# Approval store backend: memory | redis
# - memory: In-memory store (default, no external dependencies, lost on restart)
# - redis: Redis-based store (persistent, survives restart, horizontally scalable)
# NOTE: Redis requires REDIS_URL to be configured (see REDIS section above)
APPROVAL_STORE=redis

# Approval cleanup worker interval (seconds)
# Worker cleans up expired approval references in tenant indices
# Default: 300 (5 minutes)
# Set to 0 to disable cleanup worker
APPROVAL_CLEANUP_INTERVAL=300

# Default approval TTL (seconds)
# How long approval tokens remain valid
# Default: 3600 (1 hour)
APPROVAL_DEFAULT_TTL=3600

#############################################
# SOVEREIGN MODE
#############################################

# Sovereign Mode Egress Enforcement
# Enable host firewall-based egress blocking for sovereign mode
BRAIN_SOVEREIGN_MODE_ENABLED=false

# IPv6 Policy: block | allowlist | off
# - block: Block all IPv6 egress traffic (default, fail-closed)
# - allowlist: Allow only specific IPv6 destinations (requires configuration)
# - off: No IPv6 enforcement (NOT RECOMMENDED - security bypass risk)
BRAIN_SOVEREIGN_IPV6_POLICY=block

# IPv6 Allowlist (comma-separated, only used if policy=allowlist)
# Example: fc00::1,fe80::1
BRAIN_SOVEREIGN_IPV6_ALLOWLIST=

# DMZ Gateway Control
# Enable/disable DMZ gateway services (Telegram, WhatsApp, Discord, Email)
BRAIN_DMZ_ENABLED=false

# DMZ Logging Level
DMZ_LOG_LEVEL=INFO

# Telegram Gateway Configuration
TELEGRAM_BOT_TOKEN=
TELEGRAM_MODE=polling
TELEGRAM_WEBHOOK_URL=

# WhatsApp Gateway Configuration
WHATSAPP_PHONE_NUMBER=

# Discord Gateway Configuration
DISCORD_BOT_TOKEN=
DISCORD_COMMAND_PREFIX=!

# Email Gateway Configuration
EMAIL_IMAP_HOST=
EMAIL_IMAP_PORT=993
EMAIL_SMTP_HOST=
EMAIL_SMTP_PORT=587
EMAIL_ADDRESS=
EMAIL_PASSWORD=
EMAIL_POLL_INTERVAL=60

#############################################
# PAYCORE - Payment Processing Module
#############################################

# Stripe Configuration
# Get your keys from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# Stripe Redirect URLs (after checkout)
STRIPE_SUCCESS_URL=https://example.com/payment/success
STRIPE_CANCEL_URL=https://example.com/payment/cancel

# PayPal Configuration (optional)
# Get credentials from: https://developer.paypal.com/dashboard/
PAYPAL_CLIENT_ID=
PAYPAL_CLIENT_SECRET=
PAYPAL_MODE=sandbox  # sandbox | live

# PayCore Settings
PAYCORE_DEFAULT_CURRENCY=EUR
PAYCORE_REFUND_SUPERVISOR_THRESHOLD=10000  # Refunds above this amount (in cents) require policy approval
PAYCORE_ENABLE_DAILY_AGGREGATION=false  # Set true to enable daily revenue aggregation


#############################################
# WEBGENESIS (Sprint II - Operational Hardening)
#############################################

# Release retention (number of releases to keep)
BRAIN_WEBGENESIS_RELEASE_KEEP=5

# Health check configuration
BRAIN_WEBGENESIS_HEALTH_TIMEOUT=60  # seconds
BRAIN_WEBGENESIS_HEALTH_RETRIES=3

# Health check backoff (linear)
BRAIN_WEBGENESIS_HEALTH_BACKOFF=5  # seconds between retries


#############################################
# HETZNER DNS (Sprint II - DNS Automation)
#############################################

# Hetzner DNS API Token (required for DNS operations)
# Get token from: https://dns.hetzner.com/settings/api-token
HETZNER_DNS_API_TOKEN=your_hetzner_dns_token_here

# Allowed DNS zones (comma-separated, STRICT allowlist)
# Example: example.com,subdomain.example.com
HETZNER_DNS_ALLOWED_ZONES=

# Default DNS TTL (seconds)
HETZNER_DNS_DEFAULT_TTL=300

# Public IP addresses (used as default DNS record values)
# If not set, DNS value must be provided in deployment spec
BRAIN_PUBLIC_IPV4=
BRAIN_PUBLIC_IPV6=

# Hetzner DNS API timeout (seconds)
HETZNER_DNS_API_TIMEOUT=30

#####################################################################################
# NOTE: Remember to change the default passwords and secret keys before deploying to production!
#####################################################################################


